\chapter{The Linear Paul Trap}
\label{chap:LinTrap}

\section{Single ion in a linear Paul Trap}
\label{sec:1Ion}
The linear Paul trap is a radiofrequency (RF) device for trapping charged particles. It consists of four rods, each of which is split into three electrodes as is seen on \cref{fig:PaulTrap}. The coordinate system for the trap is defined such that the $z$-axis runs down the centre of the trap,
while the $x,y$-axes go between diagonally opposed rods. Furthermore, we define $z_0$ to be half the length of the center electrodes, and $r_0$ as half the distance between diagonally opposed electrodes as seen on \cref{fig:PaulTrap}.
\begin{figure}
    \centering
    \includegraphics{main/Paul_Trap.pdf}
    \caption{Example schematic of a linear Paul trap showing: (left) a 3D model of the Paul Trap with both the DC endcap voltages applied.
    (right) An end-view down the Paul trap, showing the phase of the RF voltages applied to the different rods}
    \label{fig:PaulTrap}
\end{figure}


In order to trap an ion along the $z$-direction a static voltage $V_{end}$ is applied to all the electrodes on the end of the rods (also called endcap electrodes). By applying such a voltage to the endcap electrodes, an electrical potential is generated, which in the region around the centre of the trap can be written as
\begin{equation}
    \phi_{DC}(z) = \frac{\kappa V_{end}}{z_0^2}z^2,
    \label{eq:phi_DC_z} 
\end{equation}
where $\kappa$ is a constant defined by the specific geometry of the trap, and $z$ is the position of the ion along the $z$ axis.
Thus, an ion of mass $m$ and charge $Q$ finds itself sitting in a harmonic potential
\begin{equation}
    \label{eq:omega_z}
    V_{DC}(z) = \frac{1}{2}m\omega_z^2 z^2, \quad\omega_z = \sqrt{\frac{2Q\kappa V_{end}}{mz_0^2}},
\end{equation}
where $\omega_z$ is the frequency of the ion's oscillating motion along the $z$-axis.

In order to trap the particle in the radial plane it is necessary to take a slightly different approach. Indeed, Earnshaw's theorem \cite{EarnshawOnTN} states
that it is impossible to trap a charged particle in all three directions, solely through the use of electrostatic potentials. If we look at the electrical potential in the $x,y$-plane from the DC endcaps we find
\begin{equation}
    \phi_{DC}(x,y) = -\frac{\kappa V_{end}}{2z_0^2}(x^2+y^2),
\end{equation}
which is clearly repulsive.

To counteract this repulsion, we employ an RF voltage, oscillating at frequency $\Omega_{RF}$, with an amplitude $V_{RF}$ on all four rods. Neighbouring rods have opposite phases, while diagonally opposing rods share a phase, as seen on \cref{fig:PaulTrap}.
The total time dependent electrical potential in the $x,y$-plane is given by \cite{Fisher_2017}
\begin{equation}
    \phi(x,y,t) = -\frac{\kappa V_{end}}{2z_0^2}(x^2+y^2)-\frac{V_{RF}}{2r_0^2}(x^2-y^2)\cos{(\Omega_{RF}t)},
\end{equation}
where the first term comes from the DC potential, and the second term comes from the RF voltages applied to the rods. \Cref{tab:params} shows the experimental parameters for the Paul trap used here at Aarhus.

\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|}
    \hline
    $r_0$         & 2.6mm  \\ \hline
    $z_0$         & 2mm    \\ \hline
    $\Omega_{RF}$ & 5.2MHz \\ \hline
    $\kappa$      & 0.248  \\ \hline
    \end{tabular}
    \caption{Table showing experimental parameters for the cryogenic linear Paul trap used by the ion trap group in Aarhus}
    \label{tab:params}
    \end{table}

The equations of motion in the radial plane can be expressed in a compact form by adopting the notation
\begin{equation}
    \tau = \frac{\Omega_{RF}t}{2},\quad a = -\frac{4Q\kappa V_{DC}}{mz_0^2\Omega_{RF}^2},\quad q_x = -q_y = 
    \frac{2QV_{RF}}{mr_0^2\Omega_{RF}^2},
\end{equation}
which allows for the equations of motion to be written as
\begin{equation}
    \frac{\text{d}^2\gamma}{\text{d}\tau^2} + (a-2q_\gamma\cos{(2\tau)})\gamma = 0,\quad \gamma\in\{x,y\}
    \label{eq:Mathieu}.
\end{equation}
\Cref{eq:Mathieu} is known as the Mathieu equation \cite{Abramowitz_1972}, and has bounded (stable) solutions for several sets of $(a,q_\gamma)$ parameters,
however, the conditions usually used in experiments state that for a given value of $q_\gamma$, $a$ must be found between the two curves approximated by \cite{Abramowitz_1972}
\begin{align}
    &a_0(q_\gamma) \approx -\frac{1}{2}q_\gamma^2 +\frac{7}{128}q_\gamma^4 -\frac{29}{2304}q_\gamma^6+\frac{68687}{18874368}q_\gamma^8,\\
    &b_1(q_\gamma) \approx 1-q_\gamma-\frac{1}{8}q_\gamma^2+\frac{1}{64}q_\gamma^3-\frac{1}{1536}q_\gamma^4-\frac{11}{36864}q_\gamma^5.
\end{align}
Together these two lines form what is known as a stability diagram. Since a positive DC voltage is needed for confinement in the axial direction, we restrict ourselves to considering stability in the $a<0$ region. A plot of these stability curves can be seen on \cref{fig:Stability1}.
\begin{figure}
    \centering
    \includegraphics[width =0.8\textwidth]{main/Stability.png}
    \caption{Plot of the Mathieu stability diagram for negative values of $a$. The blue colored area contains the set of bounded, and thus stable solutions to the Mathieu equation of \cref{eq:Mathieu}, which are used for experiments}
    \label{fig:Stability1}
\end{figure}

In the case where $\vert a\vert,\vert q_\gamma\vert\ll 1$, the solution to \cref{eq:Mathieu} can be approximated to
\begin{equation}
    \label{eq:omega_r}
    \gamma(t) = \gamma_0\bigg(1-\frac{q_\gamma}{2}\cos{(\Omega_{RF}t)}\bigg)\cos{(\omega_r t)},\quad \omega_r = \frac{\Omega_{RF}}{2}\sqrt{\frac{q_\gamma^2}{2}+a}.
\end{equation}
Since $\vert q_\gamma\vert\ll 1$ we see that there is a large-amplitude motion of the ion at frequency $\omega_r$. This motion is typically referred to as secular motion in the literature, and is much slower than the RF frequency of the trap (typically 10's-100's of kHz vs. 5.2MHz in the case of our trap). 

In addition, there is a small-amplitude motion which oscillates at the RF frequency superimposed on top of the secular motion. This motion is typically referred to as micromotion, and from \cref{eq:omega_r} it is clear that its amplitude grows, as the ion moves further away from the trap centre. The full picture we arrive at, is one of the ion performing slow, but large oscillations in the radial plane, with an additional micromotion on top. An example trajectory can be seen on \cref{fig:micromotion}, where the micromotion is clearly visible.



\begin{figure}
    \centering
    \includegraphics[width = 0.8\textwidth]{main/Micromotion.png}
    \caption{Trajectories including (blue) micromotion and calculated through the pseudopotential approximation (orange), for $\gamma_0 = 5 {\mu}$m, $\omega_r = 2\pi\times 50$kHz, $\Omega_{RF} = 2\pi\times 5.2$MHz.}
    \label{fig:micromotion}
\end{figure}

It is common to average over the micromotion of the ion, keeping only the term oscillating at $\omega_r$. If this is done, the dynamics of the ion can be calculated via an effective potential, (often referred to as pseudopotential in the literature) given by
\begin{equation}
    V_{Pseudo}(\gamma) = \frac{1}{2}m\omega_r^2\gamma^2,\quad \gamma\in\{x,y\}.
\end{equation}
The pseudopotential approximation is especially useful when working with trapped ions in a quantum mechanical regime, since their Hamiltonian is then simply that of a harmonic oscillator, which is one of the most well-studied examples in all of quantum mechanics.
\section{Two ions in a linear Paul trap}
\label{sec:2Ion}
We now move on to the topic of two co-trapped ions in a Paul trap. We shall denote the ions with indices 1 and 2, and write their masses and charges as $m_1,m_2,Q_1,Q_2$, respectively.
Including the Coulomb interaction between the two ions, the potential energy of the system in the pseudopotential approximation is
\begin{align}
    \nonumber V(\vec{r_1},\vec{r_2}) = &\frac{1}{2}m_1\bigg(\omega_{1,z}^2z_1^2+\omega_{1,r}^2(x_1^2+y_1^2)\bigg)+\frac{1}{2}m_2\bigg(\omega_{2,z}^2+\omega_{2,r}^2(x_2^2+y_2^2)\bigg)\\
    & +\frac{Q_2Q_2}{4\pi\epsilon_0}\frac{1}{\vert \vec{r}_1-\vec{r}_2\vert},
    \label{eq:fullV}
\end{align}
where $\vec{r}_j$ is the position vector of ion $j$, and $\omega_{j,(r/z)}$ is calculated as in \cref{eq:omega_r,eq:omega_z}, using the mass and charge of ion $j$.
For the rest of the derivations in this report we are, unless otherwise noted, going to ignore the $y$ part of the ions' motion since the system exhibits a radial symmetry, and thus any equations that hold for $x$ will hold for $y$ as well.

We shall first derive the equilibrium positions for the two ions. Assuming the radial trapping is stronger than the axial trapping, the ions will along themselves along the $z$-axis, and thus we slightly simplify the potential to be minimized
\begin{equation}
    V(z_1,z_2) = \frac{1}{2}m_1\omega_{1,z}^2z_1^2 + \frac{1}{2}m_2\omega_{2,z}^2z_2^2 + \frac{Q_1Q_2}{4\pi\epsilon_0}\frac{1}{z_1-z_2},
\end{equation}
where we assume without loss of generality that $z_1>z_2$. Taking the derivatives with respect to the ion coordinates to be zero we find
\begin{align}
    &\frac{\partial V}{\partial z_{1}} = m_1\omega_{1,z}^2z_{1,eq} - \frac{Q_1Q_2}{4\pi\epsilon_0}\frac{1}{(z_{1,eq}-z_{2,eq})^2}  = 0\label{eq:derivativeZ1},\\
    &\frac{\partial V}{\partial z_{2}} = m_2\omega_{2,z}^2z_{2,eq} + \frac{Q_1Q_2}{4\pi\epsilon_0}\frac{1}{(z_{1,eq}-z_{2,eq})^2} = 0,
\end{align}
where the $(eq)$ subscript denotes the value is taken at the equilibrium position. Adding the two together yields
\begin{equation}
    z_{1,eq} = -\rho z_{2,eq},
\end{equation}
where $\rho = \frac{Q_2}{Q_1}$ is the charge ratio between the two ions. Here it is interesting to note that the relationship between the two ions' equilibrium positions is solely determined by their charge ratio.
Plugging this relationship back into \cref{eq:derivativeZ1} an expression for $z_{1,eq}$ can be found
\begin{equation}
    z_{1,eq} =\bigg(\frac{Q_1Q_2}{4\pi\epsilon_0m_1\omega_{1,z}^2}\frac{1}{(1+\frac{1}{\rho})^2}\bigg)^{1/3}.
\end{equation}
It has to be noted, that if one expands the $\omega_{1,z}^2$ factor in the denominator, one finds that the equilibrium position is mass independent. This has not been done here, as it lengthens the expression considerably.

In this derivation we assumed the ions aligned themselves along the $z$-axis, which is the desirable case for experiments, since this minimizes micromotion. In practice however, one has to design the experiment such that the voltages applied result in such an orientation. This leads to further "stability" requirements for the two-ion system.
Following the derivation above, similar expressions for equilibrium positions along the $x$-axis may be found. Naturally, the ions align themselves along the axis which has the lowest energy at equilibrium. Calculation shows, that if the ions are to align along $z$, the following inequality must hold:
\begin{equation}
    \frac{m_1m_2\omega_{1,z}^2\omega_{2,z}^2}{m_1\omega_{1,z}^2+m_2\omega_{2,z}^2} < \frac{m_1m_2\omega_{1,r}^2\omega_{2,r}^2}{m_1\omega_{1,r}^2+m_2\omega_{2,r}^2}.
\end{equation}
In addition to being on the correct axis, the ions must also uphold the stability criteria outlined in \cref{sec:1Ion}. Given that both ions need to be stable \textit{and} trapped along the $z$-axis, the new stability diagram can look considerably different. An example for a polyporphyrin of mass 9000amu and charge 24e trapped alongside Ba$^+$ is seen on \cref{fig:Stability2}.
\begin{figure}
    \centering
    \includegraphics[width = \textwidth]{main/Stability2.png}
    \caption{Stability diagram for Ba$^+$ cotrapped alongside a polyporphyrin system, holding 12 porphyrin rings with 2 charges each for a total of $m_2 = 9000$amu, $Q_2 = 24$e. The green area represents the $a$ and $q$ parameters ideal for experiments as both ions have stable trajectories, while they also align along the $z$-axis.
    For trapping parameters that fall within the blue area the ions have stable trajectories, but will align along the radial axes. Finally, the red shaded area describes the parameters for which only the Ba$^+$ ion has stable trajectories. It is thus clear that trapping two ions with very different mass-to-charge ratios puts considerable additional bounds on the stability of the system}
    \label{fig:Stability2}
\end{figure}


With the equilibrium positions of the ions, and the criteria for them to be stably trapped determined, we can derive the new oscillation frequencies of the ions. To do so we reintroduce the full potential of \cref{eq:fullV}, and perform a Taylor expansion to 2nd order around the equilibrium position of the system. When performing calculations of vibrational modes for coupled oscillators, it is common to introduce mass-weighted displacement coordinates defined as
\begin{equation}
    \xi_1 = \sqrt{m_1}(z_{eq,1}-z_1),\quad \xi_2 = \sqrt{m_2}(z_{2,eq}-z_2),\quad \xi_3 = \sqrt{m_1}x_1,\quad \xi_4 = \sqrt{m_2}x_2.
\end{equation}
The Lagrangian in this coordinate system is
\begin{equation}
    \mathcal{L} = \sum_{i=1}^4 \dot{\xi}_i^2 - \frac{1}{2} \sum_{i = 1}^4K_{ij}\xi_i\xi_j,
\end{equation}
where $K_{ij} = \bigg(\frac{1}{\sqrt{m_im_j}}\frac{\partial^2 V}{\partial r_i\partial r_j}\bigg\vert_{eq}\bigg)$ and $\{r_1,r_2,r_3,r_4\} = \{z_1,z_2,x_1,x_2\}$. It should be noted that the Taylor expansion includes an energy offset corresponding to the potential energy when the system is in equilibrium. We ignore this offset as it introduces no dynamics.

Explicit calculation of the $K_{ij}$ terms grants several zeroes. The non-zero $K_{ij}$'s evaluate to
\begin{align}
    &K_{11} = \omega_{1,z}^2\bigg(1+\frac{2}{1+1/\rho}\bigg),\\
    &K_{12} = K_ {21} = -\frac{2\omega_{1,z}^2}{\sqrt{\mu}(1+1/\rho)},\\
    &K_{22} = \omega_{1,z}^2\frac{\rho}{\mu}\bigg(1+\frac{2}{1+\rho}\bigg),\\
    &K_{33} = \omega_{1,r}^2 - \frac{\omega_{1,z}^2}{1+1/\rho},\\
    &K_{34} = K_{43} = -\frac{1}{2}K_{12},\\
    &K_{44} = \omega_{2,r}^2-\frac{\omega_{1,z}^2}{\mu(1+1/\rho)}.
\end{align}
The coupled motional modes as well as their oscillation frequencies can now be found by diagonalizing the matrix \cite{Taylor[2005]}
\begin{equation}
    K = \begin{bmatrix}
        K_{11} & K_{12} & 0 & 0\\
        K_{21} & K_{22} & 0 & 0\\
        0 & 0 & K_{33} & K_{34}\\
        0 & 0 & K_{43} & K_{44}\\
    \end{bmatrix},
\end{equation}
which is block diagonal. This simplifies the problem significantly, as it suffices to solve the eigenproblem for the two 2$\times$2 matrices on the diagonal
\begin{equation}
    K_{z} = \begin{bmatrix}
        K_{11} & K_{12}\\
        K_{21} & K_{22}\\
    \end{bmatrix},
    \quad
    K_{r}
    \begin{bmatrix}
        K_{33} & K_{34}\\
        K_{43} & K_{44}\\
    \end{bmatrix},
\end{equation}
which will give the solutions for the axial and radial motion respectively.
Solving the problem yields two modes for each direction, one where the ions move in-phase with one another, and one where they move out-of-phase.
For the frequencies we find
\begin{align}
    &\big(\omega_z^{i/o}\big)^2 = \frac{K_{11}+K_{22}\mp\sqrt{(K_{11}-K_{22})^2+4K_{12}^2}}{2},\\
    &\big(\omega_r^{i/o}\big)^2 = \frac{K_{33}+K_{44}\pm\sqrt{(K_{33}-K_{44})^2+4K_{34}^2}}{2},
\end{align}
where the (i/o) superscript denotes in-phase and out-of-phase respectively. Expanding the $K_{ij}$'s above would make the equations considerably harder to read, and as such is not done here. Denoting the normalized eigenmodes for the axial motion as $\vec{\alpha_{i/o}}$, and the ones for radial motion $\vec{\beta_{i/o}}$ one finds
\begin{align}
    &\vec{\alpha_{i/o}} = \frac{1}{\sqrt{1+\tilde{\alpha}_{i/o}^2}}
    \begin{pmatrix}
        \tilde{\alpha}_{i/o} \\
        1
    \end{pmatrix},\quad \tilde{\alpha}_{i/o} = \frac{\big(\omega_z^{i/o}\big)^2-K_{22}}{K_{12}},\\
    &\vec{\beta_{i/o}} = \frac{1}{\sqrt{1+\tilde{\beta}_{i/o}^2}}
    \begin{pmatrix}
        \tilde{\beta}_{i/o} \\
        1
    \end{pmatrix},\quad \tilde{\beta}_{i/o} = \frac{\big(\omega_r^{i/o}\big)^2-K_{44}}{K_{34}}.
\end{align}
Here the first component of the vector describes the amplitude, often referred to as the contribution or participation, of ion 1 in the motional mode, while the 2nd component of the vector describes the participation of ion 2.


For ions with very different charge-to-mass ratios we find that the motion of the ions becomes essentially uncoupled. As an example we consider once again a Ba$^+$ ion trapped alongside a polyporphyrin ($m_2 = 9000$amu, $Q_2 = 24$e), here the axial eigenvector for the in-phase motion is $\vec{\alpha_{i}} = (0.092,0.99)$. Thus, the in-phase motion of this system consists almost exclusively motion of the heavy polyporphyrin. This decoupling of motion has significant consequences for cooling, as will be seen in \cref{chap:Cooling}.


While the equations above are not expanded, in order to ensure ease of reading, it is interesting to note that, roughly, $\tilde{\alpha}_{i/o}\propto\rho/\mu$, while $\tilde{\beta}_{i/o}\propto(\rho/\mu)^2$. This means the decoupling of the ion motion tends to be larger along the radial direction as the charge-to-mass ratios of the two ions become more skewed.
